<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Movie Player</title>
  <meta name="color-scheme" content="dark light"/>
  <link rel="stylesheet" href="output.css">
</head>
<body>
  <div class="sidebar">
    <button id="homeBtn" class="home-btn">
      <strong>Movie<br>Player</strong>
    </button>
    <a class="navlink" href="https://www.facebook.com/aivan.abanto1/" target="_blank">Contact</a>
    <button class="navbtn" id="openHelp">Ad-block</button>
    <a class="navlink" href="https://www.imdb.com/" target="_blank">IMDb</a>
    <button class="navbtn" id="openAbout">About</button>
    <button class="navbtn" id="openHistory">History</button>
  </div>

  <dialog id="historyModal">
    <div class="modal-header">
      <div class="modal-title">Watch History</div>
      <button class="close-x" id="historyClose" aria-label="Close">‚úï</button>
    </div>
    <div class="modal-body">
      <ul id="historyList"></ul>
    </div>
  </dialog>

  <main class="main">
    <header class="header">
      <h1>Free Movies</h1>
      <p>Search or paste an IMDb ID (e.g., <code>tt11083552</code>), pick a server, then hit Watch.</p>
    </header>

    <section class="wrap">
      <div class="toolbar" role="group" aria-label="Controls">
        <select id="seasonSelect" class="select" style="display:none"></select>
        <select id="episodeSelect" class="select" style="display:none"></select>
        <div class="relative">
          <input id="imdbInput" class="input" placeholder="Enter IMDb link, ID, or movie name" autocomplete="off" />
          <div id="suggestions" class="suggestions"></div>
        </div>
        <button id="searchBtn" class="btn blue" type="button">üîç Search</button>
        <select id="serverSelect" class="select" aria-label="Server">
          <option value="vidsrc">Server 1 ‚Äì 2Embed</option>
          <option value="vidsrcto">Server 2 ‚Äì Vidsrc.me</option>
          <option value="2embed">Server 3 ‚Äì Vidsrc.to</option>
          <option value="noads">Server 4 ‚Äì Test (fewer ads)</option>
        </select>
        <button id="watchBtn" class="btn primary" type="button">‚ñ∂ Watch</button>
        <button id="copyBtn" class="btn" type="button" title="Copy share link">üîó Copy Link</button>
        <button id="fullscreenBtn" class="btn" type="button" title="Fullscreen">‚õ∂ Fullscreen</button>
      </div>

      <div id="results" class="results"></div>

      <div class="player" id="playerContainer" aria-live="polite">
        <div id="spinner"></div>
        <div class="frame-wrap">
          <iframe id="movieFrame"
            allow="fullscreen; picture-in-picture; clipboard-write; encrypted-media; autoplay"
            referrerpolicy="no-referrer"
            src=""
            allowfullscreen="true"
            webkitallowfullscreen="true"
            mozallowfullscreen="true">
          </iframe>
        </div>
        <div id="movieInfo" class="movie-info" style="display:none;">
          <h2 id="movieTitle"></h2>
          <button id="toggleInfo" class="toggle-btn">More info ‚ñº</button>
          <div id="extraInfo" class="info-content">
            <p><strong>Release Date:</strong> <span id="releaseDate">N/A</span></p>
            <p><strong>Overview:</strong> <span id="overview">N/A</span></p>
            <p><strong>Rating:</strong> <span id="rating">N/A</span></p>
          </div>
        </div>
        <div class="status" id="status">
          <span class="dot" aria-hidden="true"></span>
          <span id="statusText">Ready. Tip: Press <kbd>Enter</kbd> or click Search to find movies.</span>
        </div>
        <div class="footer">
          <p><strong>Heads-up:</strong> Only embed content you have the rights to watch. Some third-party players show ads; see <em>Ad-block Help</em> for tips. If a server fails, try a different one.</p>
        </div>
      </div>
    </section>
  </main>

  <dialog id="helpModal">
    <div class="modal-header">
      <div class="modal-title">Watch with fewer ads using 
        <a href="https://chromewebstore.google.com/detail/ublock-origin-lite/ddkjiahejlhfcafbddmgiahcphecmpfh?hl=en" 
           target="_blank" rel="noopener noreferrer">
          uBlock Origin Lite
        </a>
      </div>
      <button class="close-x" id="helpClose" aria-label="Close">‚úï</button>
    </div>
    <div class="modal-body">
      <p>These steps are for Chromium-based browsers (Chrome, Edge, Brave, etc.). For Firefox, install the classic <em>uBlock Origin</em> add-on.</p>
      <ol>
        <li>Install <strong>
          <a href="https://chromewebstore.google.com/detail/ublock-origin-lite/ddkjiahejlhfcafbddmgiahcphecmpfh?hl=en" 
             target="_blank" rel="noopener noreferrer">
             uBlock Origin Lite
          </a>
        </strong> from the Chrome Web Store.</li>
        <li>Pin it and make sure blocking is <strong>On</strong> for this site.</li>
        <li>Reload. Most popups/banners should be gone.</li>
      </ol>
    </div>
  </dialog>

  <dialog id="aboutModal">
    <div class="modal-header">
      <div class="modal-title">About This Site</div>
      <button class="close-x" id="aboutClose" aria-label="Close">‚úï</button>
    </div>
    <div class="modal-body">
      <p>Welcome to our Free Movies platform! Search by movie title or paste an IMDb ID, then click a movie card to load it instantly in the player. </p>
      <p>This site is completely <strong>free</strong> to use and open for you to explore. Want to make it your own? Fork the code on <a href="https://github.com/aivanleigh25" target="_blank">GitHub</a> with proper credit to us! ‚úåÔ∏è </p>
      <p>Have fun, contribute, or reach out via GitHub if you have ideas or questions!</p>
    </div>
  </dialog>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    var gk_isXlsx = false;
    var gk_xlsxFileLookup = {};
    var gk_fileData = {};
    function filledCell(cell) {
      return cell !== '' && cell != null;
    }
    function loadFileData(filename) {
      if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
        try {
          var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
          var firstSheetName = workbook.SheetNames[0];
          var worksheet = workbook.Sheets[firstSheetName];
          var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
          var filteredData = jsonData.filter(row => row.some(filledCell));
          var headerRowIndex = filteredData.findIndex((row, index) =>
            row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
          );
          if (headerRowIndex === -1 || headerRowIndex > 25) {
            headerRowIndex = 0;
          }
          var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
          csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
          return csv;
        } catch (e) {
          console.error(e);
          return "";
        }
      }
      return gk_fileData[filename] || "";
    }
  </script>
  <script src="mobile-fix.js"></script>
  <script src="main.js"></script>
  <script src="copy-link.js"></script>
</body>
</html>
